â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            AUTHENTICATION MIDDLEWARE QUICK REFERENCE                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ FILE: server/middleware/auth.js (284 lines) âœ…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MIDDLEWARE FUNCTIONS                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ğŸ”’ protect                                                               â”‚
â”‚    Purpose: Require JWT authentication                                  â”‚
â”‚    Usage: router.get('/profile', protect, getProfile)                   â”‚
â”‚    Adds: req.user (full user object, password excluded)                 â”‚
â”‚    Errors: 401 (no token, invalid, expired, user not found, inactive)   â”‚
â”‚                                                                          â”‚
â”‚ ğŸ‘¥ authorize(...roles)                                                  â”‚
â”‚    Purpose: Role-based access control                                   â”‚
â”‚    Usage: router.post('/grade', protect, authorize('mentor'), grade)    â”‚
â”‚    Roles: 'student', 'team-lead', 'mentor'                              â”‚
â”‚    Errors: 401 (not authenticated), 403 (wrong role)                    â”‚
â”‚    Note: Must be used AFTER protect middleware                          â”‚
â”‚                                                                          â”‚
â”‚ ğŸ“ checkProjectMember                                                   â”‚
â”‚    Purpose: Verify user is project member                               â”‚
â”‚    Usage: router.get('/:id', protect, checkProjectMember, getProject)   â”‚
â”‚    Adds: req.project (full project object)                              â”‚
â”‚    Checks: creator, team lead, mentor, or member                        â”‚
â”‚    Errors: 404 (not found), 403 (not member)                            â”‚
â”‚                                                                          â”‚
â”‚ ğŸ‘” checkProjectLeadOrMentor                                             â”‚
â”‚    Purpose: Verify user is lead or mentor                               â”‚
â”‚    Usage: router.put('/:id', protect, checkProjectLeadOrMentor, update) â”‚
â”‚    Adds: req.project                                                    â”‚
â”‚    Checks: team lead OR mentor only                                     â”‚
â”‚    Errors: 404 (not found), 403 (not lead/mentor)                       â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”“ optionalAuth                                                         â”‚
â”‚    Purpose: Optional authentication (public routes)                     â”‚
â”‚    Usage: router.get('/explore', optionalAuth, explore)                 â”‚
â”‚    Adds: req.user (if valid token provided)                             â”‚
â”‚    Errors: None (always continues)                                      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UTILITY FUNCTIONS                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ğŸ« generateToken(id)                                                    â”‚
â”‚    Returns: JWT access token                                            â”‚
â”‚    Expiry: 7 days (configurable via JWT_EXPIRE)                         â”‚
â”‚    Payload: { id, email, role }                                         â”‚
â”‚    Usage: const token = generateToken(user._id)                         â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”„ generateRefreshToken(id)                                             â”‚
â”‚    Returns: JWT refresh token                                           â”‚
â”‚    Expiry: 30 days (configurable via JWT_REFRESH_EXPIRE)                â”‚
â”‚    Payload: { id }                                                      â”‚
â”‚    Usage: const refreshToken = generateRefreshToken(user._id)           â”‚
â”‚                                                                          â”‚
â”‚ ğŸª setTokenCookie(res, token)                                           â”‚
â”‚    Purpose: Set HTTP-only cookie with token                             â”‚
â”‚    Options: httpOnly, secure (prod), sameSite: strict                   â”‚
â”‚    Usage: setTokenCookie(res, token)                                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TOKEN EXTRACTION                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ âœ… From Authorization Header (Primary)                                  â”‚
â”‚    Header: Authorization: Bearer <token>                                â”‚
â”‚    Extracted: req.headers.authorization.split(' ')[1]                   â”‚
â”‚                                                                          â”‚
â”‚ âœ… From Cookies (Alternative)                                           â”‚
â”‚    Cookie: token=<token>                                                â”‚
â”‚    Extracted: req.cookies.token                                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ERROR CODES & MESSAGES                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ 401 Unauthorized                                                         â”‚
â”‚  â€¢ "Not authorized to access this route. Please login."                 â”‚
â”‚  â€¢ "Invalid token. Please login again."                                 â”‚
â”‚  â€¢ "Token expired. Please login again."                                 â”‚
â”‚  â€¢ "User not found. Token invalid."                                     â”‚
â”‚  â€¢ "User account is deactivated."                                       â”‚
â”‚  â€¢ "User not authenticated"                                             â”‚
â”‚                                                                          â”‚
â”‚ 403 Forbidden                                                            â”‚
â”‚  â€¢ "User role '{role}' is not authorized to access this route"          â”‚
â”‚  â€¢ "You are not a member of this project"                               â”‚
â”‚  â€¢ "Only project lead or mentor can perform this action"                â”‚
â”‚                                                                          â”‚
â”‚ 404 Not Found                                                            â”‚
â”‚  â€¢ "Project not found"                                                  â”‚
â”‚                                                                          â”‚
â”‚ 500 Internal Server Error                                               â”‚
â”‚  â€¢ "Authentication failed"                                              â”‚
â”‚  â€¢ "Error checking project membership"                                  â”‚
â”‚  â€¢ "Error checking project permissions"                                 â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USAGE PATTERNS                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ğŸ”¹ Basic Authentication                                                  â”‚
â”‚    router.get('/profile', protect, getProfile);                         â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”¹ Role-Based Access                                                     â”‚
â”‚    router.post('/assign', protect, authorize('mentor'), assign);        â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”¹ Multiple Roles                                                        â”‚
â”‚    router.put('/update',                                                â”‚
â”‚      protect,                                                           â”‚
â”‚      authorize('mentor', 'team-lead'),                                  â”‚
â”‚      update                                                             â”‚
â”‚    );                                                                   â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”¹ Project Membership                                                    â”‚
â”‚    router.get('/projects/:id',                                          â”‚
â”‚      protect,                                                           â”‚
â”‚      checkProjectMember,                                                â”‚
â”‚      getProject                                                         â”‚
â”‚    );                                                                   â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”¹ Project Leadership                                                    â”‚
â”‚    router.delete('/projects/:id',                                       â”‚
â”‚      protect,                                                           â”‚
â”‚      checkProjectLeadOrMentor,                                          â”‚
â”‚      deleteProject                                                      â”‚
â”‚    );                                                                   â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”¹ Optional Auth (Public + Private)                                     â”‚
â”‚    router.get('/explore', optionalAuth, explore);                       â”‚
â”‚                                                                          â”‚
â”‚ ğŸ”¹ Cascade Protection (All Routes)                                      â”‚
â”‚    router.use(protect);                                                 â”‚
â”‚    router.get('/dashboard', getDashboard);                              â”‚
â”‚    router.post('/create', create);                                      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLIENT-SIDE USAGE                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ğŸ“¤ Sending Token (Axios)                                                â”‚
â”‚    axios.get('/api/profile', {                                          â”‚
â”‚      headers: {                                                         â”‚
â”‚        Authorization: `Bearer ${token}`                                 â”‚
â”‚      }                                                                  â”‚
â”‚    });                                                                  â”‚
â”‚                                                                          â”‚
â”‚ ğŸ“¤ Sending Token (Fetch)                                                â”‚
â”‚    fetch('/api/profile', {                                              â”‚
â”‚      headers: {                                                         â”‚
â”‚        'Authorization': `Bearer ${token}`                               â”‚
â”‚      }                                                                  â”‚
â”‚    });                                                                  â”‚
â”‚                                                                          â”‚
â”‚ ğŸ“¤ Global Axios Interceptor                                             â”‚
â”‚    axios.interceptors.request.use(config => {                           â”‚
â”‚      const token = localStorage.getItem('token');                       â”‚
â”‚      if (token) {                                                       â”‚
â”‚        config.headers.Authorization = `Bearer ${token}`;                â”‚
â”‚      }                                                                  â”‚
â”‚      return config;                                                     â”‚
â”‚    });                                                                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SERVER-SIDE EXAMPLES                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ğŸ” Login Controller                                                      â”‚
â”‚    const user = await User.findByCredentials(email, password);          â”‚
â”‚    const token = generateToken(user._id);                               â”‚
â”‚    const refreshToken = generateRefreshToken(user._id);                 â”‚
â”‚    setTokenCookie(res, token);                                          â”‚
â”‚    res.json({ token, refreshToken, user });                             â”‚
â”‚                                                                          â”‚
â”‚ ğŸ‘¤ Access User in Protected Route                                       â”‚
â”‚    const getProfile = async (req, res) => {                             â”‚
â”‚      const user = req.user; // Set by protect middleware                â”‚
â”‚      res.json({ user });                                                â”‚
â”‚    };                                                                   â”‚
â”‚                                                                          â”‚
â”‚ ğŸ“ Access Project in Project Route                                      â”‚
â”‚    const getTasks = async (req, res) => {                               â”‚
â”‚      const project = req.project; // Set by checkProjectMember          â”‚
â”‚      const tasks = await Task.find({ project: project._id });           â”‚
â”‚      res.json({ tasks });                                               â”‚
â”‚    };                                                                   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SECURITY FEATURES                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ âœ… HTTP-Only Cookies        - Prevents XSS attacks                       â”‚
â”‚ âœ… Password Exclusion        - Never returns passwords                   â”‚
â”‚ âœ… Token Expiration          - Configurable expiry times                 â”‚
â”‚ âœ… Refresh Tokens            - Separate long-lived tokens                â”‚
â”‚ âœ… Active User Check         - Blocks deactivated accounts               â”‚
â”‚ âœ… Role Validation           - Prevents privilege escalation             â”‚
â”‚ âœ… HTTPS in Production       - Secure cookies in prod                    â”‚
â”‚ âœ… CSRF Protection           - SameSite cookie attribute                 â”‚
â”‚ âœ… Comprehensive Errors      - Specific error messages                   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ENVIRONMENT VARIABLES                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ JWT_SECRET=your_jwt_secret_key               âœ… Required                â”‚
â”‚ JWT_EXPIRE=7d                                âœ… Required                â”‚
â”‚ JWT_REFRESH_SECRET=your_refresh_secret       âœ… Required                â”‚
â”‚ JWT_REFRESH_EXPIRE=30d                       âœ… Required                â”‚
â”‚ NODE_ENV=development                         âœ… Required                â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TESTING                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ğŸ§ª Run Test Suite:                                                      â”‚
â”‚    node server/tests/authMiddleware.test.js                             â”‚
â”‚                                                                          â”‚
â”‚ âœ… Test Results: 13/13 passed (100% success)                            â”‚
â”‚                                                                          â”‚
â”‚ Tests Cover:                                                            â”‚
â”‚  â€¢ No token, invalid token, expired token                               â”‚
â”‚  â€¢ User not found, inactive user                                        â”‚
â”‚  â€¢ Valid authentication                                                 â”‚
â”‚  â€¢ Cookie-based authentication                                          â”‚
â”‚  â€¢ Role-based authorization                                             â”‚
â”‚  â€¢ Optional authentication                                              â”‚
â”‚  â€¢ Token generation utilities                                           â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DOCUMENTATION                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ ğŸ“š Full Docs:     server/docs/AUTH_MIDDLEWARE.md                        â”‚
â”‚ ğŸ§ª Test Suite:    server/tests/authMiddleware.test.js                   â”‚
â”‚ ğŸ’¡ Quick Ref:     This file                                             â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  STATUS: âœ… PRODUCTION READY                                            â•‘
â•‘  TESTS:  âœ… 13/13 PASSED (100%)                                         â•‘
â•‘  DOCS:   âœ… COMPLETE                                                    â•‘
â•‘  FILE:   server/middleware/auth.js (284 lines)                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
